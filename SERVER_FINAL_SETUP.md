# –§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### 1. –ü–æ–ª—É—á–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
cd ~/laravel/public_html
git pull origin main
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ DeployController

```bash
ls -la app/Http/Controllers/Api/DeployController.php
```

–î–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å —Ñ–∞–π–ª.

### 3. –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É —Å —Ç–∞–±–ª–∏—Ü–µ–π cache)

```bash
php8.2 artisan migrate
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã, –≤–∫–ª—é—á–∞—è `cache`.

### 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env

```bash
nano .env
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å:

```env
DEPLOY_TOKEN=your-secret-token-here
DEPLOY_SERVER_URL=https://project.siteaccess.ru
```

**–í–ê–ñ–ù–û:** –¢–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ç–æ–∫–µ–Ω–æ–º –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º `.env`!

### 5. –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à (–ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–π)

```bash
php8.2 artisan route:clear
php8.2 artisan config:clear
php8.2 artisan cache:clear
```

### 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å endpoint

```bash
php8.2 artisan route:list | grep deploy
```

–î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å: `POST api/deploy`

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
php artisan deploy --insecure
```

–î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è:
- ‚úÖ HTTP 200
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º –¥–µ–ø–ª–æ–µ
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö

---

## –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞ —Å —Ç–∞–±–ª–∏—Ü–µ–π cache

```bash
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
php8.2 artisan migrate

# –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ persists, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
php8.2 artisan db:show
```

### DeployController –Ω–µ –Ω–∞–π–¥–µ–Ω

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω
git pull origin main

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª
ls -la app/Http/Controllers/Api/DeployController.php
```

### Endpoint –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
# –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à —Ä–æ—É—Ç–æ–≤
php8.2 artisan route:clear

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–æ—É—Ç—ã
php8.2 artisan route:list | grep deploy

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
tail -f storage/logs/laravel.log
```

---

## –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ —Å–∏—Å—Ç–µ–º–∞ –¥–µ–ø–ª–æ—è –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ! üöÄ

